```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>企业合同数据分析看板</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <style>
        :root {
            --primary: #1e88e5;
            --secondary: #f5f7fa;
            --success: #4caf50;
            --danger: #f44336;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            padding: 20px;
            line-height: 1.6;
        }
        
        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
            flex-wrap: wrap;
        }
        
        h1 {
            color: var(--primary);
            font-size: 28px;
            font-weight: 600;
        }
        
        .download-btn {
            background: linear-gradient(135deg, var(--primary), #1565c0);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            position: fixed;
            top: 25px;
            right: 25px;
            z-index: 100;
        }
        
        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(30, 136, 229, 0.4);
        }
        
        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .kpi-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .kpi-card:hover {
            transform: translateY(-5px);
        }
        
        .kpi-title {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .kpi-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--primary);
        }
        
        .kpi-change {
            font-size: 16px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
            margin-top: auto;
        }
        
        .positive {
            background-color: rgba(76, 175, 80, 0.15);
            color: var(--success);
        }
        
        .negative {
            background-color: rgba(244, 67, 54, 0.15);
            color: var(--danger);
        }
        
        .summary {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            line-height: 1.8;
        }
        
        .summary h2 {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            height: 380px;
            display: flex;
            flex-direction: column;
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .chart-wrapper {
            flex: 1;
            position: relative;
        }
        
        .data-table {
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 40px;
            overflow-x: auto;
        }
        
        .data-table h2 {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: right;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background-color: #f5f7fa;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        th:first-child, td:first-child {
            text-align: left;
        }
        
        .download-bottom {
            text-align: center;
            margin: 20px 0 40px;
        }
        
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .download-btn {
                position: relative;
                top: 0;
                right: 0;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>企业营销合同数据分析看板</h1>
            <button class="download-btn" id="downloadBtn">下载Word报表</button>
        </div>
        
        <div class="kpi-container">
            <div class="kpi-card">
                <div class="kpi-title">本月合同总额</div>
                <div class="kpi-value">967.55万元</div>
                <div class="kpi-change positive">↑31.64%</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">合同利润总额</div>
                <div class="kpi-value">749.66万元</div>
                <div class="kpi-change positive">↑35.64%</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">合同单数</div>
                <div class="kpi-value">1,344单</div>
                <div class="kpi-change positive">↑12.47%</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">平均合同单价</div>
                <div class="kpi-value">5,577元</div>
                <div class="kpi-change positive">↑20.61%</div>
            </div>
        </div>
        
        <div class="summary">
            <h2>分析总结</h2>
            <p>11月合同数据分析显示：合同总额达967.55万元，环比增长31.64%，合同利润749.66万元，环比大幅增长35.64%。单数增至1,344单，环比增长12.47%，平均合同单价提升至5,577元，增幅20.61%。营销部贡献最大（376.11万元，占比38.87%），全民营销次之（246.73万元，占25.50%），会销部增速最快（环比增长62.88%）。</p>
            <p>关键增长点：营销部单数增长（523单，环比+3.56%），全民营销金额提升明显（环比+13.34%），平均合同单价全面上涨反映业务质量提升。风险点：门店业务合同额环比下降8.04%，加盟商增速放缓（环比+69.87%但基数低）。建议：1）优化营销部资源配置维持高增长；2）加强门店业务数字化营销；3）拓展全民营销渠道；4）监控会销部增长可持续性。整体毛利率77.48%，成本控制良好，但需关注佣金成本环比倍增的影响。</p>
        </div>
        
        <div class="charts-grid">
            <div class="chart-container">
                <div class="chart-title">各部门合同金额排名（万元）</div>
                <div class="chart-wrapper">
                    <canvas id="barChart"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <div class="chart-title">合同金额部门分布</div>
                <div class="chart-wrapper">
                    <canvas id="pieChart"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <div class="chart-title">近三月合同金额趋势（万元）</div>
                <div class="chart-wrapper">
                    <canvas id="lineChart"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <div class="chart-title">部门合同利润排名（万元）</div>
                <div class="chart-wrapper">
                    <canvas id="horizontalBarChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="data-table">
            <h2>详细数据对比分析</h2>
            <table>
                <thead>
                    <tr>
                        <th>部门</th>
                        <th>11月合同额</th>
                        <th>10月合同额</th>
                        <th>环比增长</th>
                        <th>11月利润</th>
                        <th>10月利润</th>
                        <th>利润环比</th>
                        <th>11月单数</th>
                        <th>10月单数</th>
                        <th>单数环比</th>
                        <th>平均单价</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>营销部</td>
                        <td>376.11</td>
                        <td>310.24</td>
                        <td class="positive">+21.23%</td>
                        <td>273.43</td>
                        <td>249.91</td>
                        <td class="positive">+9.41%</td>
                        <td>523</td>
                        <td>505</td>
                        <td class="positive">+3.56%</td>
                        <td>7,192</td>
                    </tr>
                    <tr>
                        <td>全民营销</td>
                        <td>246.73</td>
                        <td>217.64</td>
                        <td class="positive">+13.34%</td>
                        <td>191.23</td>
                        <td>139.84</td>
                        <td class="positive">+36.74%</td>
                        <td>417</td>
                        <td>352</td>
                        <td class="positive">+18.47%</td>
                        <td>5,918</td>
                    </tr>
                    <tr>
                        <td>会销部</td>
                        <td>115.71</td>
                        <td>71.05</td>
                        <td class="positive">+62.88%</td>
                        <td>110.45</td>
                        <td>68.64</td>
                        <td class="positive">+60.93%</td>
                        <td>103</td>
                        <td>48</td>
                        <td class="positive">+114.58%</td>
                        <td>11,234</td>
                    </tr>
                    <tr>
                        <td>交付中心</td>
                        <td>104.51</td>
                        <td>29.81</td>
                        <td class="positive">+250.57%</td>
                        <td>69.30</td>
                        <td>21.96</td>
                        <td class="positive">+215.57%</td>
                        <td>10</td>
                        <td>7</td>
                        <td class="positive">+42.86%</td>
                        <td>104,507</td>
                    </tr>
                    <tr>
                        <td>门店业务</td>
                        <td>46.55</td>
                        <td>50.62</td>
                        <td class="negative">-8.04%</td>
                        <td>38.20</td>
                        <td>25.26</td>
                        <td class="positive">+51.25%</td>
                        <td>145</td>
                        <td>116</td>
                        <td class="positive">+25.00%</td>
                        <td>3,211</td>
                    </tr>
                    <tr>
                        <td>招商加盟部</td>
                        <td>20.86</td>
                        <td>12.72</td>
                        <td class="positive">+63.99%</td>
                        <td>19.76</td>
                        <td>12.59</td>
                        <td class="positive">+56.86%</td>
                        <td>7</td>
                        <td>6</td>
                        <td class="positive">+16.67%</td>
                        <td>29,800</td>
                    </tr>
                    <tr>
                        <td>新媒体</td>
                        <td>28.31</td>
                        <td>11.50</td>
                        <td class="positive">+146.17%</td>
                        <td>25.83</td>
                        <td>10.85</td>
                        <td class="positive">+138.06%</td>
                        <td>117</td>
                        <td>127</td>
                        <td class="negative">-7.87%</td>
                        <td>2,420</td>
                    </tr>
                    <tr>
                        <td>加盟商</td>
                        <td>21.03</td>
                        <td>12.38</td>
                        <td class="positive">+69.87%</td>
                        <td>16.45</td>
                        <td>10.12</td>
                        <td class="positive">+62.51%</td>
                        <td>8</td>
                        <td>7</td>
                        <td class="positive">+14.29%</td>
                        <td>26,288</td>
                    </tr>
                    <tr>
                        <td>合道市场部</td>
                        <td>5.57</td>
                        <td>12.03</td>
                        <td class="negative">-53.70%</td>
                        <td>3.35</td>
                        <td>8.97</td>
                        <td class="negative">-62.63%</td>
                        <td>8</td>
                        <td>17</td>
                        <td class="negative">-52.94%</td>
                        <td>6,966</td>
                    </tr>
                    <tr>
                        <td>城市合伙人</td>
                        <td>2.17</td>
                        <td>6.97</td>
                        <td class="negative">-68.86%</td>
                        <td>1.66</td>
                        <td>4.53</td>
                        <td class="negative">-63.38%</td>
                        <td>6</td>
                        <td>10</td>
                        <td class="negative">-40.00%</td>
                        <td>3,621</td>
                    </tr>
                    <tr style="font-weight: bold; background-color: #f0f8ff;">
                        <td>汇总</td>
                        <td>967.55</td>
                        <td>734.95</td>
                        <td class="positive">+31.64%</td>
                        <td>749.66</td>
                        <td>552.68</td>
                        <td class="positive">+35.64%</td>
                        <td>1,344</td>
                        <td>1,195</td>
                        <td class="positive">+12.47%</td>
                        <td>5,577</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="download-bottom">
            <button class="download-btn" id="downloadBtnBottom">下载Word报表</button>
        </div>
    </div>

    <script>
        // 注册插件
        Chart.register(ChartDataLabels);
        
        // 柱状图数据
        const barData = {
            labels: ['营销部', '全民营销', '会销部', '交付中心', '门店业务', '招商加盟部', '新媒体', '加盟商', '合道市场部', '城市合伙人'],
            datasets: [{
                label: '合同金额(万元)',
                data: [376.11, 246.73, 115.71, 104.51, 46.55, 20.86, 28.31, 21.03, 5.57, 2.17],
                backgroundColor: [