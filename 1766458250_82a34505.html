<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>企业数据分析看板</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin: 0;
            font-family: "Microsoft YaHei", sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        .container {
            padding: 20px;
            max-width: 1400px;
            margin: auto;
        }

        h1 {
            text-align: center;
            color: #007BFF;
        }

        .kpi-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .kpi-card {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            flex: 1 1 200px;
            margin: 10px;
            transition: transform 0.3s ease;
        }

        .kpi-card:hover {
            transform: scale(1.03);
        }

        .kpi-title {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }

        .kpi-value {
            font-size: 24px;
            font-weight: bold;
            color: #007BFF;
        }

        .analysis {
            margin-top: 30px;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .analysis h2 {
            color: #007BFF;
            margin-bottom: 10px;
        }

        .analysis p {
            line-height: 1.6;
            color: #333;
        }

        .charts {
            margin-top: 30px;
        }

        .chart-container {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        canvas {
            max-width: 100%;
            height: auto;
        }

        .table-container {
            margin-top: 30px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            padding: 12px 15px;
            border: 1px solid #ddd;
            text-align: center;
        }

        th {
            background: #007BFF;
            color: white;
        }

        tr:nth-child(even) {
            background: #f9f9f9;
        }

        .positive {
            color: green;
        }

        .negative {
            color: red;
        }

        .download-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: #007BFF;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }

        .download-btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>企业XX数据分析看板</h1>

    <div class="kpi-container">
        <div class="kpi-card">
            <div class="kpi-title">合同金额</div>
            <div class="kpi-value">9,675,523.94</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">毛利</div>
            <div class="kpi-value">7,496,623.32</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">10月环比增长率</div>
            <div class="kpi-value">31.65%</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-title">税金</div>
            <div class="kpi-value">138,644.13</div>
        </div>
    </div>

    <div class="analysis">
        <h2>文字分析总结</h2>
        <p><strong>营运能力：</strong>10月合同金额环比增长31.65%，显示业务拓展能力增强。收款金额同比增长16.57%，说明回款效率提升。</p>
        <p><strong>盈利能力：</strong>合同毛利达到749万元，环比增长35.64%。预估成本下降3.48%，有助于提高利润率。</p>
        <p><strong>关键增长点：</strong>10月应付佣金增长99.07%，可能是销售激励政策的推动结果。平均合同单价上涨20.6%，表明客户价值提升。</p>
    </div>

    <div class="charts">
        <div class="chart-container">
            <canvas id="barChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="pieChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="lineChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="horizontalBarChart"></canvas>
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>指标</th>
                    <th>2025.11月</th>
                    <th>2025.10月</th>
                    <th>2025.9月</th>
                    <th>10月环比变化</th>
                    <th>增长率</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>合同金额</td>
                    <td>9,675,523.94</td>
                    <td>7,349,546.28</td>
                    <td>10,809,466.61</td>
                    <td>2,325,977.66</td>
                    <td class="positive">31.65%</td>
                </tr>
                <tr>
                    <td>收款金额</td>
                    <td>6,299,169.46</td>
                    <td>5,403,920.82</td>
                    <td>7,265,986.26</td>
                    <td>895,248.64</td>
                    <td class="positive">16.57%</td>
                </tr>
                <tr>
                    <td>税金</td>
                    <td>138,644.13</td>
                    <td>94,324.80</td>
                    <td>177,209.12</td>
                    <td>44,319.33</td>
                    <td class="positive">46.99%</td>
                </tr>
                <tr>
                    <td>预估成本</td>
                    <td>1,318,270.49</td>
                    <td>1,365,749.22</td>
                    <td>1,832,211.20</td>
                    <td>-47,478.73</td>
                    <td class="negative">-3.48%</td>
                </tr>
                <tr>
                    <td>应付佣金</td>
                    <td>721,986.00</td>
                    <td>362,672.00</td>
                    <td>501,571.00</td>
                    <td>359,314.00</td>
                    <td class="positive">99.07%</td>
                </tr>
                <tr>
                    <td>月代账费</td>
                    <td>189,316.09</td>
                    <td>131,624.15</td>
                    <td>158,512.65</td>
                    <td>57,691.94</td>
                    <td class="positive">43.83%</td>
                </tr>
                <tr>
                    <td>合同毛利</td>
                    <td>7,496,623.32</td>
                    <td>5,526,800.26</td>
                    <td>8,298,475.29</td>
                    <td>1,969,823.06</td>
                    <td class="positive">35.64%</td>
                </tr>
                <tr>
                    <td>平均合同单价</td>
                    <td>5,577.84</td>
                    <td>4,624.94</td>
                    <td>4,969.15</td>
                    <td>nan</td>
                    <td class="positive">20.60%</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<button class="download-btn" onclick="downloadAsWord()">一键下载看板</button>

<script>
    // 数据
    const data = {
        labels: ["合同金额", "收款金额", "税金", "预估成本", "应付佣金", "月代账费", "合同毛利", "平均合同单价"],
        values: [9675523.94, 6299169.46, 138644.13, 1318270.49, 721986, 189316.09, 7496623.32, 5577.84],
        growthRates: [0.3165, 0.1657, 0.4699, -0.0348, 0.9907, 0.4383, 0.3564, 0.206]
    };

    // 柱状图
    const barCtx = document.getElementById('barChart').getContext('2d');
    new Chart(barCtx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: [{
                label: '金额 (元)',
                data: data.values,
                backgroundColor: '#007BFF'
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // 饼图
    const pieCtx = document.getElementById('pieChart').getContext('2d');
    new Chart(pieCtx, {
        type: 'pie',
        data: {
            labels: data.labels,
            datasets: [{
                label: '金额占比',
                data: data.values,
                backgroundColor: ['#007BFF', '#6610f2', '#6f42c1', '#e83e8c', '#dc3545', '#fd7e14', '#ffc107', '#28a745']
            }]
        },
        options: {
            responsive: true
        }
    });

    // 折线图
    const lineCtx = document.getElementById('lineChart').getContext('2d');
    new Chart(lineCtx, {
        type: 'line',
        data: {
            labels: ['2025.11月', '2025.10月', '2025.9月'],
            datasets: [{
                label: '合同金额',
                data: [9675523.94, 7349546.28, 10809466.61],
                borderColor: '#007BFF',
                fill: false
            }, {
                label: '合同毛利',
                data: [7496623.32, 5526800.26, 8298475.29],
                borderColor: '#28a745',
                fill: false
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // 横向条形图
    const horizontalCtx = document.getElementById('horizontalBarChart').getContext('2d');
    new Chart(horizontalCtx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: [{
                label: '增长率',
                data: data.growthRates.map(rate => rate * 100),
                backgroundColor: '#007BFF'
            }]
        },
        options: {
            indexAxis: 'y',
            responsive: true,
            scales: {
                x: {
                    beginAtZero: true
                }
            }
        }
    });

    function downloadAsWord() {
        const content = `
            <html xmlns:o="urn:schemas-microsoft-com:office:office"
                  xmlns:w="urn:schemas-microsoft-com:office:word"
                  xmlns="http://www.w3.org/TR/REC-html40">
            <head>
                <meta charset="utf-8">
                <title>企业XX数据分析看板</title>
                <style>
                    body { font-family: "Microsoft YaHei", sans-serif; }
                    table { border-collapse: collapse; width: 100%; }
                    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
                    th { background-color: #007BFF; color: white; }
                </style>
            </head>
            <body>
                <h1 style="text-align:center;">企业XX数据分析看板</h1>
                <h2 style="color:#007BFF;">KPI 关键指标卡片</h2>
                <ul>
                    <li>合同金额: 9,675,523.94 元</li>
                    <li>毛利: 7,496,623.32 元</li>
                    <li>10月环比增长率: 31.65%</li>
                    <li>税金: 138,644.13 元</li>
                </ul>
                <h2 style="color:#007BFF;">文字分析总结</h2>
                <p><strong>营运能力：</strong>10月合同金额环比增长31.65%，显示业务拓展能力增强。收款金额同比增长16.57%，说明回款效率提升。</p>
                <p><strong>盈利能力：</strong>合同毛利达到749万元，环比增长35.64%。预估成本下降3.48%，有助于提高利润率。</p>
                <p><strong>关键增长点：</strong>10月应付佣金增长99.07%，可能是销售激励政策的推动结果。平均合同单价上涨20.6%，表明客户价值提升。</p>
                <h2 style="color:#007BFF;">详细数据对比表格</h2>
                <table>
                    <thead>
                        <tr>
                            <th>指标</th>
                            <th>2025.11月</th>
                            <th>2025.10月</th>
                            <th>2025.9月</th>
                            <th>10月环比变化</th>
                            <th>增长率</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>合同金额</td>
                            <td>9,675,523.94</td>
                            <td>7,349,546.28</td>
                            <td>10,809,466.61</td>
                            <td>2,325,977.66</td>
                            <td style="color:green;">31.65%</td>
                        </tr>
                        <tr>
                            <td>收款金额</td>
                            <td>6,299,169.46</td>
                            <td>5,403,920.82</td>
                            <td>7,265,986.26</td>
                            <td>895,248.64</td>
                            <td style="color:green;">16.57%</td>
                        </tr>
                        <tr>
                            <td>税金</td>
                            <td>138,644.13</td>
                            <td>94,324.80</td>
                            <td>177,209.12</td>
                            <td>44,319.33</td>
                            <td style="color:green;">46.99%</td>
                        </tr>
                        <tr>
                            <td>预估成本</td>
                            <td>1,318,270.49</td>
                            <td>1,365,749.22</td>
                            <td>1,832,211.20</td>
                            <td>-47,478.73</td>
                            <td style="color:red;">-3.48%</td>
                        </tr>
                        <tr>
                            <td>应付佣金</td>
                            <td>721,986.00</td>
                            <td>362,672.00</td>
                            <td>501,571.00</td>
                            <td>359,314.00</td>
                            <td style="color:green;">99.07%</td>
                        </tr>
                        <tr>
                            <td>月代账费</td>
                            <td>189,316.09</td>
                            <td>131,624.15</td>
                            <td>158,512.65</td>
                            <td>57,691.94</td>
                            <td style="color:green;">43.83%</td>
                        </tr>
                        <tr>
                            <td>合同毛利</td>
                            <td>7,496,623.32</td>
                            <td>5,526,800.26</td>
                            <td>8,298,475.29</td>
                            <td>1,969,823.06</td>
                            <td style="color:green;">35.64%</td>
                        </tr>
                        <tr>
                            <td>平均合同单价</td>
                            <td>5,577.84</td>
                            <td>4,624.94</td>
                            <td>4,969.15</td>
                            <td>nan</td>
                            <td style="color:green;">20.60%</td>
                        </tr>
                    </tbody>
                </table>
            </body>
            </html>
        `;

        const blob = new Blob([content], { type: 'application/msword' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = '企业XX数据分析看板.doc';
        a.click();
        URL.revokeObjectURL(url);
    }
</script>
</body>
</html>