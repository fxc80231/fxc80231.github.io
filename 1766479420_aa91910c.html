```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>企业营销合同数据分析看板</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  <style>
    :root {
      --primary: #1e88e5;
      --secondary: #64b5f6;
      --accent: #ff9800;
      --success: #4caf50;
      --danger: #f44336;
      --light: #f8f9fa;
      --dark: #212529;
      --gray: #e0e0e0;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
    }

    body {
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
      padding: 20px;
    }

    .dashboard {
      max-width: 1400px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid var(--primary);
    }

    h1 {
      color: var(--primary);
      margin-bottom: 10px;
      font-size: 32px;
    }

    .kpi-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 30px;
    }

    .kpi-card {
      flex: 1;
      min-width: 250px;
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .kpi-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
    }

    .kpi-title {
      font-size: 18px;
      color: #546e7a;
      margin-bottom: 15px;
      font-weight: 600;
    }

    .kpi-value {
      font-size: 32px;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 10px;
    }

    .kpi-change {
      font-size: 16px;
      padding: 5px 12px;
      border-radius: 20px;
      font-weight: 500;
    }

    .positive {
      background-color: rgba(76, 175, 80, 0.15);
      color: var(--success);
    }

    .negative {
      background-color: rgba(244, 67, 54, 0.15);
      color: var(--danger);
    }

    .analysis-section {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
    }

    .section-title {
      font-size: 24px;
      color: var(--primary);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--gray);
    }

    .analysis-content {
      font-size: 16px;
      line-height: 1.8;
    }

    .highlight {
      background-color: #fff9c4;
      padding: 0 4px;
      font-weight: 500;
    }

    .charts-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 30px;
    }

    .chart-card {
      flex: 0 1 calc(50% - 10px);
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
      min-height: 400px;
      display: flex;
      flex-direction: column;
    }

    @media (max-width: 768px) {
      .chart-card {
        flex: 0 1 100%;
      }
    }

    .chart-wrapper {
      flex: 1;
      position: relative;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
      margin-bottom: 30px;
    }

    th, td {
      padding: 16px 20px;
      text-align: center;
      border: 1px solid #e0e0e0;
    }

    th {
      background-color: var(--primary);
      color: white;
      font-weight: 600;
    }

    tr:nth-child(even) {
      background-color: #f5f7fa;
    }

    .table-container {
      overflow-x: auto;
      margin-bottom: 30px;
    }

    .download-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 30px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(30, 136, 229, 0.4);
      z-index: 100;
      transition: all 0.3s ease;
    }

    .download-btn:hover {
      background: #1565c0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(30, 136, 229, 0.5);
    }

    .bottom-download {
      text-align: center;
      margin-top: 20px;
    }

    .download-section-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 15px 35px;
      border-radius: 30px;
      font-weight: 600;
      font-size: 18px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(30, 136, 229, 0.4);
      transition: all 0.3s ease;
      margin-bottom: 30px;
    }

    .download-section-btn:hover {
      background: #1565c0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(30, 136, 229, 0.5);
    }

    .note {
      text-align: center;
      font-size: 14px;
      color: #78909c;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="dashboard">
    <button class="download-btn" id="downloadBtn">下载Word报告</button>

    <header>
      <h1>企业营销合同数据分析看板</h1>
      <p>数据周期：2023年9月 - 2023年11月</p>
    </header>

    <div class="kpi-container">
      <div class="kpi-card">
        <div class="kpi-title">本月合同总额</div>
        <div class="kpi-value">9,675,523.94元</div>
        <div class="kpi-change positive">↑31.64%</div>
        <div>环比上月</div>
      </div>
      <div class="kpi-card">
        <div class="kpi-title">本月合同利润</div>
        <div class="kpi-value">7,496,623.32元</div>
        <div class="kpi-change positive">↑35.65%</div>
        <div>环比上月</div>
      </div>
      <div class="kpi-card">
        <div class="kpi-title">平均合同单价</div>
        <div class="kpi-value">5,577.84元</div>
        <div class="kpi-change positive">↑20.60%</div>
        <div>环比上月</div>
      </div>
      <div class="kpi-card">
        <div class="kpi-title">合同单数</div>
        <div class="kpi-value">1,344单</div>
        <div class="kpi-change positive">↑12.47%</div>
        <div>环比上月</div>
      </div>
    </div>

    <div class="analysis-section">
      <h2 class="section-title">经营分析总结</h2>
      <div class="analysis-content">
        <p>11月整体合同金额达<span class="highlight">967.55万元</span>，环比增长31.64%，同比增长16.84%，三大核心指标均呈现显著上升趋势。利润总额达<span class="highlight">749.66万元</span>，环比增长35.65%，毛利率达77.48%，较上月提升4.3个百分点，盈利能力持续增强。主要增长来自于营销部（376.11万元）和会销部（115.71万元），环比分别增长21.22%和62.88%。</p>

        <p>从业务板块看，全民营销板块贡献最大（246.73万元，占比25.5%），但需关注其佣金支出占比偏高（9.65%）。营销部单量达523单，环比增长3.56%，平均合同单价7,197元，环比提升21.3%，反映客单价优化策略初见成效。新媒体板块环比增长146.14%，成为增速最快的业务单元。</p>

        <p>风险点方面，交付中心佣金占比达25.27%，显著高于其他部门（平均7.46%），需优化交付成本结构。城市合伙人平均合同单价仅3,621元，低于整体均值35%，建议提升高价值客户占比。11月门店业务环比下降8.04%，需加强门店引流策略。</p>

        <p>建议：1）优化交付中心成本结构，控制佣金比例在15%以内；2）加强全民营销渠道的风控管理，建立客户信用评级体系；3）针对城市合伙人推出高客单价产品组合；4）拓展新媒体获客渠道，保持增长势头。</p>
      </div>
    </div>

    <div class="charts-container">
      <div class="chart-card">
        <h3>各部门合同金额分布（万元）</h3>
        <div class="chart-wrapper">
          <canvas id="barChart"></canvas>
        </div>
      </div>

      <div class="chart-card">
        <h3>合同金额部门占比</h3>
        <div class="chart-wrapper">
          <canvas id="pieChart"></canvas>
        </div>
      </div>

      <div class="chart-card">
        <h3>月度合同金额趋势（万元）</h3>
        <div class="chart-wrapper">
          <canvas id="lineChart"></canvas>
        </div>
      </div>

      <div class="chart-card">
        <h3>部门合同金额环比增长</h3>
        <div class="chart-wrapper">
          <canvas id="horizontalBarChart"></canvas>
        </div>
      </div>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>部门</th>
            <th>11月合同额(元)</th>
            <th>10月合同额(元)</th>
            <th>环比增长</th>
            <th>9月合同额(元)</th>
            <th>环比增长(10月)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>营销部</td>
            <td>3,761,089.38</td>
            <td>3,102,411.28</td>
            <td style="color: #4caf50;">↑21.22%</td>
            <td>4,859,092.63</td>
            <td style="color: #f44336;">↓36.17%</td>
          </tr>
          <tr>
            <td>全民营销</td>
            <td>2,467,254.96</td>
            <td>2,176,385.60</td>
            <td style="color: #4caf50;">↑13.36%</td>
            <td>2,352,318.32</td>
            <td style="color: #f44336;">↓7.46%</td>
          </tr>
          <tr>
            <td>会销部</td>
            <td>1,157,117.04</td>
            <td>710,466.58</td>
            <td style="color: #4caf50;">↑62.88%</td>
            <td>996,529.00</td>
            <td style="color: #f44336;">↓28.71%</td>
          </tr>
          <tr>
            <td>门店业务</td>
            <td>465,502.00</td>
            <td>506,196.00</td>
            <td style="color: #f44336;">↓8.04%</td>
            <td>347,934.00</td>
            <td style="color: #4caf50;">↑45.49%</td>
          </tr>
          <tr>
            <td>交付中心</td>
            <td>1,045,070.00</td>
            <td>298,100.00</td>
            <td style="color: #4caf50;">↑250.78%</td>
            <td>460,224.00</td>
            <td style="color: #f44336;">↓35.24%</td>
          </tr>
          <tr>
            <td>新媒体</td>
            <td>283,131.98</td>
            <td>115,018.21</td>
            <td style="color: #4caf50;">↑146.14%</td>
            <td>604,754.25</td>
            <td style="color: #f44336;">↓80.98%</td>
          </tr>
          <tr>
            <td>加盟商</td>
            <td>210,300.00</td>
            <td>123,780.00</td>
            <td style="color: #4caf50;">↑69.90%</td>
            <td>349,776.00</td>
            <td style="color: #f44336;">↓64.61%</td>
          </tr>
          <tr>
            <td>招商加盟部</td>
            <td>208,600.00</td>
            <td>127,200.00</td>
            <td style="color: #4caf50;">↑64.00%</td>
            <td>231,600.00</td>
            <td style="color: #f44336;">↓45.09%</td>
          </tr>
          <tr>
            <td>合道市场部</td>
            <td>55,730.00</td>
            <td>120,300.00</td>
            <td style="color: #f44336;">↓53.68%</td>
            <td>326,314.50</td>
            <td style="color: #f44336;">↓63.14%</td>
          </tr>
          <tr>
            <td>城市合伙人</td>
            <td>21,728.58</td>
            <td>69,688.61</td>
            <td style="color: #f44336;">↓68.82%</td>
            <td>137,321.93</td>
            <td style="color: #f44336;">↓49.24%</td>
          </tr>
          <tr style="font-weight: bold; background-color: #e3f2fd;">
            <td>汇总</td>
            <td>9,675,523.94</td>
            <td>7,349,546.28</td>
            <td style="color: #4caf50;">↑31.64%</td>
            <td>10,809,466.61</td>
            <td style="color: #f44336;">↓32.02%</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="bottom-download">
      <button class="download-section-btn" id="downloadBottomBtn">下载完整分析报告</button>
      <div class="note">下载内容包含完整图表、数据表格及分析结论</div>
    </div>
  </div>

  <script>
    // 初始化图表
    document.addEventListener('DOMContentLoaded', function() {
      // 柱状图 - 各部门合同金额排名
      const barCtx = document.getElementById('barChart').getContext('2d');
      const barChart = new Chart(barCtx, {
        type: 'bar',
        data: {
          labels: ['营销部', '全民营销', '会销部', '交付中心', '