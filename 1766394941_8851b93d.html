<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>企业数据分析看板</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #f4f6f8;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .dashboard-container {
      padding: 2rem;
    }
    .kpi-card {
      background: linear-gradient(135deg, #007bff, #00c6ff);
      color: white;
      border-radius: 10px;
      padding: 1.5rem;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
      transition: transform 0.3s ease;
    }
    .kpi-card:hover {
      transform: scale(1.03);
    }
    .card-title {
      font-size: 1.2rem;
      margin-bottom: 0.5rem;
    }
    .card-value {
      font-size: 1.5rem;
      font-weight: bold;
    }
    .analysis-section {
      margin-top: 2rem;
    }
    .chart-container {
      background: white;
      border-radius: 10px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .table-responsive {
      max-height: 300px;
      overflow-y: auto;
    }
    table thead th {
      background: #007bff;
      color: white;
    }
    table tbody tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    table tbody tr:hover {
      background-color: #e9ecef;
    }
    .download-button {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
    }
    .download-button button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .download-button button:hover {
      background: #0056b3;
    }
    .section-title {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: #333;
    }
    .positive {
      color: green;
    }
    .negative {
      color: red;
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <h1 class="text-center mb-4">企业数据分析看板</h1>

    <!-- KPI 卡片 -->
    <div class="row">
      <div class="col-md-3">
        <div class="kpi-card">
          <div class="card-title">合同金额总额</div>
          <div class="card-value">¥1,250,000</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="kpi-card">
          <div class="card-title">毛利总额</div>
          <div class="card-value">¥450,000</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="kpi-card">
          <div class="card-title">同比增长率</div>
          <div class="card-value">+12.5%</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="kpi-card">
          <div class="card-title">客户数量</div>
          <div class="card-value">85</div>
        </div>
      </div>
    </div>

    <!-- 文字分析总结 -->
    <div class="analysis-section">
      <h2 class="section-title">文字分析总结</h2>
      <p><strong>营运能力：</strong>本季度整体运营效率较上季度提升，客户转化率提高，订单处理速度加快。</p>
      <p><strong>盈利能力：</strong>毛利增长显著，主要得益于成本控制和高利润产品销售占比提升。</p>
      <p><strong>关键增长点：</strong>市场推广活动带来新客户增加，同时老客户复购率上升，是本季度业绩增长的主要驱动力。</p>
    </div>

    <!-- 图表区域 -->
    <div class="chart-container">
      <h2 class="section-title">合同金额分布（柱状图）</h2>
      <canvas id="barChart"></canvas>
    </div>

    <div class="chart-container">
      <h2 class="section-title">部门贡献比例（饼图）</h2>
      <canvas id="pieChart"></canvas>
    </div>

    <div class="chart-container">
      <h2 class="section-title">月度合同金额趋势（折线图）</h2>
      <canvas id="lineChart"></canvas>
    </div>

    <div class="chart-container">
      <h2 class="section-title">各部门排名（横向条形图）</h2>
      <canvas id="horizontalBarChart"></canvas>
    </div>

    <!-- 数据对比表格 -->
    <div class="analysis-section">
      <h2 class="section-title">详细数据对比表格</h2>
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>月份</th>
              <th>合同金额（元）</th>
              <th>同比单数</th>
              <th>同比增长率</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>2023年1月</td>
              <td>120000</td>
              <td>+5</td>
              <td>+8.3%</td>
            </tr>
            <tr>
              <td>2023年2月</td>
              <td>130000</td>
              <td>+6</td>
              <td>+10.0%</td>
            </tr>
            <tr>
              <td>2023年3月</td>
              <td>140000</td>
              <td>+7</td>
              <td>+12.5%</td>
            </tr>
            <tr>
              <td>2023年4月</td>
              <td>150000</td>
              <td>+8</td>
              <td>+15.0%</td>
            </tr>
            <tr>
              <td>2023年5月</td>
              <td>160000</td>
              <td>+9</td>
              <td>+17.5%</td>
            </tr>
            <tr>
              <td>2023年6月</td>
              <td>170000</td>
              <td>+10</td>
              <td>+20.0%</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- 下载按钮 -->
    <div class="download-button">
      <button onclick="downloadAsWord()">下载为 Word 文档</button>
    </div>
  </div>

  <!-- Chart.js 引入 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // 柱状图
    const barCtx = document.getElementById('barChart').getContext('2d');
    new Chart(barCtx, {
      type: 'bar',
      data: {
        labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
        datasets: [{
          label: '合同金额（元）',
          data: [120000, 130000, 140000, 150000, 160000, 170000],
          backgroundColor: '#007bff'
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false },
          title: { display: true, text: '合同金额分布' }
        }
      }
    });

    // 饼图
    const pieCtx = document.getElementById('pieChart').getContext('2d');
    new Chart(pieCtx, {
      type: 'pie',
      data: {
        labels: ['销售部', '技术部', '市场部', '售后部'],
        datasets: [{
          label: '部门贡献比例',
          data: [40, 25, 20, 15],
          backgroundColor: ['#007bff', '#ffc107', '#28a745', '#dc3545']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'right' },
          title: { display: true, text: '部门贡献比例' }
        }
      }
    });

    // 折线图
    const lineCtx = document.getElementById('lineChart').getContext('2d');
    new Chart(lineCtx, {
      type: 'line',
      data: {
        labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
        datasets: [{
          label: '合同金额趋势',
          data: [120000, 130000, 140000, 150000, 160000, 170000],
          borderColor: '#007bff',
          fill: false
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false },
          title: { display: true, text: '月度合同金额趋势' }
        }
      }
    });

    // 横向条形图
    const horizontalBarCtx = document.getElementById('horizontalBarChart').getContext('2d');
    new Chart(horizontalBarCtx, {
      type: 'bar',
      data: {
        labels: ['销售部', '技术部', '市场部', '售后部'],
        datasets: [{
          label: '部门贡献金额（元）',
          data: [400000, 250000, 200000, 150000],
          backgroundColor: '#007bff'
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        plugins: {
          legend: { display: false },
          title: { display: true, text: '各部门排名' }
        }
      }
    });

    function downloadAsWord() {
      const doc = new Blob(['<html><body><h1>企业数据分析看板</h1>', 
        '<h2>KPI 关键指标卡片</h2>',
        '<p>合同金额总额：¥1,250,000</p>',
        '<p>毛利总额：¥450,000</p>',
        '<p>同比增长率：+12.5%</p>',
        '<p>客户数量：85</p>',
        '<h2>文字分析总结</h2>',
        '<p><strong>营运能力：</strong>本季度整体运营效率较上季度提升，客户转化率提高，订单处理速度加快。</p>',
        '<p><strong>盈利能力：</strong>毛利增长显著，主要得益于成本控制和高利润产品销售占比提升。</p>',
        '<p><strong>关键增长点：</strong>市场推广活动带来新客户增加，同时老客户复购率上升，是本季度业绩增长的主要驱动力。</p>',
        '<h2>图表说明</h2>',
        '<p>柱状图：显示各月合同金额分布情况。</p>',
        '<p>饼图：展示各部门的合同金额贡献比例。</p>',
        '<p>折线图：反映合同金额随时间的变化趋势。</p>',
        '<p>横向条形图：比较各部门的合同金额排名。</p>',
        '<h2>详细数据对比表格</h2>',
        '<table border="1"><tr><th>月份</th><th>合同金额（元）</th><th>同比单数</th><th>同比增长率</th></tr>',
        '<tr><td>2023年1月</td><td>120000</td><td>+5</td><td>+8.3%</td></tr>',
        '<tr><td>2023年2月</td><td>130000</td><td>+6</td><td>+10.0%</td></tr>',
        '<tr><td>2023年3月</td><td>140000</td><td>+7</td><td>+12.5%</td></tr>',
        '<tr><td>2023年4月</td><td>150000</td><td>+8</td><td>+15.0%</td></tr>',
        '<tr><td>2023年5月</td><td>160000</td><td>+9</td><td>+17.5%</td></tr>',
        '<tr><td>2023年6月</td><td>170000</td><td>+10</td><td>+20.0%</td></tr>',
        '</table></body></html>'], {type: 'application/msword'});
      const link = document.createElement('a');
      link.href = URL.createObjectURL(doc);
      link.download = '企业数据分析看板.doc';
      link.click();
    }
  </script>
</body>
</html>