```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>企业营销合同数据分析看板</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <style>
        :root {
            --primary: #1e88e5;
            --primary-light: #64b5f6;
            --secondary: #f5f7fa;
            --accent: #ff9800;
            --success: #4caf50;
            --danger: #f44336;
            --text: #333;
            --text-light: #666;
            --border: #e0e0e0;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: var(--text);
            line-height: 1.6;
            padding-bottom: 40px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2.2rem;
            font-weight: 600;
        }
        
        .download-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            color: var(--primary);
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .download-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .kpi-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }
        
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }
        
        .kpi-title {
            font-size: 1rem;
            color: var(--text-light);
            margin-bottom: 10px;
        }
        
        .kpi-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .kpi-change {
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .positive {
            color: var(--success);
        }
        
        .negative {
            color: var(--danger);
        }
        
        .analysis-section {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
        }
        
        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }
        
        .analysis-content {
            font-size: 1rem;
            line-height: 1.8;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .chart-wrapper {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
        }
        
        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .chart-container {
            height: 350px;
            position: relative;
        }
        
        .data-table-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
            overflow-x: auto;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 900px;
        }
        
        .data-table th {
            background-color: var(--primary);
            color: white;
            text-align: left;
            padding: 12px 15px;
        }
        
        .data-table td {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .data-table tr:nth-child(even) {
            background-color: var(--secondary);
        }
        
        .footer-download {
            text-align: center;
            margin-top: 30px;
        }
        
        .footer-download-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 4px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .footer-download-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .chart-wrapper {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>企业营销合同数据分析看板</h1>
        </div>
    </header>

    <button class="download-btn">一键下载 Word 文档</button>

    <div class="container">
        <div class="kpi-container">
            <div class="kpi-card">
                <div class="kpi-title">本月合同总额</div>
                <div class="kpi-value">9,675.52万元</div>
                <div class="kpi-change">环比 <span class="positive">+31.64%</span></div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">本月合同毛利</div>
                <div class="kpi-value">7,496.62万元</div>
                <div class="kpi-change">环比 <span class="positive">+35.65%</span></div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">平均合同单价</div>
                <div class="kpi-value">5,577.84元</div>
                <div class="kpi-change">环比 <span class="positive">+20.61%</span></div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">合同总数</div>
                <div class="kpi-value">1,344单</div>
                <div class="kpi-change">环比 <span class="positive">+12.47%</span></div>
            </div>
        </div>

        <div class="analysis-section">
            <h2 class="section-title">分析总结</h2>
            <div class="analysis-content">
                <p>11月份公司整体合同表现强劲，合同总额达到9675.52万元，环比增长31.64%，同比增长显著。营销部仍是核心贡献部门，合同金额3761.09万元，占比38.88%。合同毛利表现优异，达到7496.62万元，毛利率77.48%，环比提升35.65%。</p>
                <p>关键增长点体现在全民营销和招商加盟板块，全民营销合同额2467.25万元，环比增长13.35%；招商加盟部合同额208.60万元，环比增长63.99%。新媒体渠道增长迅猛，合同额283.13万元，环比增长146.15%。</p>
                <p>需关注风险点：交付中心合同毛利环比下降68.43%，主要受佣金支出增加影响；会销部合同额1157.12万元，但毛利占比仅14.73%，低于平均水平。建议优化高佣金业务结构，加强会销部成本管控，提升全民营销转化效率。</p>
                <p>整体来看，公司营运状况良好，合同规模和质量同步提升。下阶段应巩固优势渠道，重点提升低效业务单元盈利能力，优化产品组合提高客单价，保持增长势头。</p>
            </div>
        </div>

        <div class="charts-container">
            <div class="chart-wrapper">
                <h3 class="chart-title">各部门合同金额排名（11月）</h3>
                <div class="chart-container">
                    <canvas id="barChart"></canvas>
                </div>
            </div>
            <div class="chart-wrapper">
                <h3 class="chart-title">合同金额部门分布</h3>
                <div class="chart-container">
                    <canvas id="pieChart"></canvas>
                </div>
            </div>
            <div class="chart-wrapper">
                <h3 class="chart-title">近三月合同金额趋势</h3>
                <div class="chart-container">
                    <canvas id="lineChart"></canvas>
                </div>
            </div>
            <div class="chart-wrapper">
                <h3 class="chart-title">合同毛利环比增长率</h3>
                <div class="chart-container">
                    <canvas id="barHorizontalChart"></canvas>
                </div>
            </div>
        </div>

        <div class="data-table-container">
            <h2 class="section-title">详细数据对比表</h2>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>部门</th>
                        <th>11月合同额(万元)</th>
                        <th>环比增长</th>
                        <th>11月毛利(万元)</th>
                        <th>环比增长</th>
                        <th>11月合同数</th>
                        <th>环比增长</th>
                        <th>平均单价(元)</th>
                        <th>环比增长</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>营销部</td>
                        <td>3,761.09</td>
                        <td class="positive">+21.24%</td>
                        <td>2,734.27</td>
                        <td class="positive">+9.42%</td>
                        <td>523</td>
                        <td class="positive">+3.56%</td>
                        <td>7,190.23</td>
                        <td class="positive">+17.05%</td>
                    </tr>
                    <tr>
                        <td>全民营销</td>
                        <td>2,467.25</td>
                        <td class="positive">+13.35%</td>
                        <td>1,912.34</td>
                        <td class="positive">+36.73%</td>
                        <td>417</td>
                        <td class="positive">+18.47%</td>
                        <td>5,917.64</td>
                        <td class="negative">-4.24%</td>
                    </tr>
                    <tr>
                        <td>会销部</td>
                        <td>1,157.12</td>
                        <td class="positive">+62.91%</td>
                        <td>1,104.52</td>
                        <td class="positive">+60.92%</td>
                        <td>103</td>
                        <td class="positive">+114.58%</td>
                        <td>11,234.15</td>
                        <td class="negative">-23.07%</td>
                    </tr>
                    <tr>
                        <td>交付中心</td>
                        <td>1,045.07</td>
                        <td class="positive">+250.77%</td>
                        <td>693.03</td>
                        <td class="negative">-68.43%</td>
                        <td>10</td>
                        <td class="positive">+42.86%</td>
                        <td>104,507.00</td>
                        <td class="positive">+145.67%</td>
                    </tr>
                    <tr>
                        <td>门店业务</td>
                        <td>465.50</td>
                        <td class="negative">-8.04%</td>
                        <td>382.03</td>
                        <td class="positive">+51.25%</td>
                        <td>145</td>
                        <td class="positive">+25.00%</td>
                        <td>3,210.36</td>
                        <td class="negative">-26.48%</td>
                    </tr>
                    <tr>
                        <td>新媒体</td>
                        <td>283.13</td>
                        <td class="positive">+146.15%</td>
                        <td>258.27</td>
                        <td class="positive">+138.08%</td>
                        <td>117</td>
                        <td class="negative">-7.87%</td>
                        <td>2,420.79</td>
                        <td class="positive">+166.76%</td>
                    </tr>
                    <tr>
                        <td>加盟商</td>
                        <td>210.30</td>
                        <td class="positive">+69.93%</td>
                        <td>164.46</td>
                        <td class="positive">+62.48%</td>
                        <td>8</td>
                        <td class="positive">+14.29%</td>
                        <td>26,287.50</td>
                        <td class="positive">+48.76%</td>
                    </tr>
                    <tr>
                        <td>招商加盟部</td>
                        <td>208.60</td>
                        <td class="positive">+63.99%</td>
                        <td>197.57</td>
                        <td class="positive">+56.90%</td>
                        <td>7</td>
                        <td class="positive">+16.67%</td>
                        <td>29,800.00</td>
                        <td class="positive">+40.54%</td>
                    </tr>
                    <tr>
                        <td>合道市场部</td>
                        <td>55.73</td>
                        <td class="negative">-53.67%</td>
                        <td>33.54</td>
                        <td class="negative">-62.63%</td>
                        <td>8</td>
                        <td class="negative">-52.94%</td>
                        <td>6,966.25</td>
                        <td class="negative">-2.16%</td>
                    </tr>
                    <tr>
                        <td>城市合伙人</td>
                        <td>21.73</td>
                        <td class="negative">-68.82%</td>
                        <td>16.60</td>
                        <td class="negative">-63.34%</td>
                        <td>6</td>
                        <td class="negative">-40.00%</td>
                        <td>3,621.43</td>
                        <td class="negative">-47.95%</td>
                    </tr>
                    <tr>
                        <td>总计</td>
                        <td>9,675.52</td>
                        <td class="positive">+31.64%</td>
                        <td>7,496.62</td>
                        <td class="positive">+35.65%</td>
                        <td>1,344</td>
                        <td class="positive">+12.47%</td>
                        <td>5,577.84</td>
                        <td class="positive">+20.61%</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="footer-download">
            <button class="footer-download-btn">下载完整分析报告</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化图表
            initBarChart();
            initPieChart();
            initLineChart();
            initHorizontalBarChart();

            // 设置下载按钮事件
            document.querySelectorAll('.download-btn, .footer-download-btn').forEach(btn => {
                btn.addEventListener('click', exportToWord);
            });
        });

        function initBarChart() {
            const ctx = document.getElementById('barChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['营销部', '全民营销', '会销部', '交付中心', '门店业务', '新媒体', '加盟商', '招商加盟部', '合道市场部', '城市合伙人'],
                    datasets: [{
                        label: '合同金额 (万元)',
                        data: [3761.09, 2467.25, 1157.12, 1045.07, 465.50, 283.13, 210.30, 208.60, 55.73, 21.73],
                        backgroundColor: [
                            '#4285F4', '#34A853', '#FBBC05', '#EA4335', '#4285F4', 
                            '#34A853', '#FBBC05', '#EA4335', '#4285F4', '#34A853'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            formatter: function(value) {
                                return value.toLocaleString('zh-CN');
                            },
                            color: '#333',
                            font: {
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '合同金额 (万元)'
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function initPieChart() {
            const ctx = document.getElementById('pieChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['营销部', '全民营销', '会销部', '交付中心', '门店业务', '新媒体', '加盟商', '招商加盟部', '合道市场部', '城市合伙人'],
                    datasets: [{
                        label: '合同金额占比',
                        data: [38.88, 25.50, 11.96, 10.80, 4.81, 2.93, 2.17, 2.16, 0.58, 0.22],
                        backgroundColor: [
                            '#4285F4', '#34A853', '#FBBC05', '#EA4335', '#4285F4', 
                            '#34A853', '#FBBC05', '#EA4335', '#4285F4', '#34A853'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            formatter: function(value, context) {
                                const amounts = [3761.09, 2467.25, 1157.12, 1045.07, 465.50, 283.13, 210.30, 208.60, 55.73, 21.73];
                                return `${value}%\n${amounts[context.dataIndex].toLocaleString('zh-CN')}万元`;
                            },
                            color: '#fff',
                            font: {
                                size: 10,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 12,
                                padding: 15
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function initLineChart() {
            const ctx = document.getElementById('lineChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['9月', '10月', '11月'],
                    datasets: [{
                        label: '合同金额 (万元)',
                        data: [10809.47, 7349.55, 9675.52],
                        borderColor: '#4285F4',
                        backgroundColor: 'rgba(66, 133, 244, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#4285F4',
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            anchor: 'center',
                            align: 'top',
                            formatter: function(value) {
                                return value.toLocaleString('zh-CN');
                            },
                            color: '#333',
                            font: {
                                weight: 'bold'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: '合同金额 (万元)'
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function initHorizontalBarChart() {
            const ctx = document.getElementById('barHorizontalChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['交付中心', '会销部', '新媒体', '招商加盟部', '加盟商', '营销部', '门店业务', '全民营销', '合道市场部', '城市合伙人'],
                    datasets: [{
                        label: '环比增长率 (%)',
                        data: [250.77, 62.91, 146.15, 63.99, 69.93, 21.24, -8.04, 13.35, -53.67, -68.82],
                        backgroundColor: function(context) {
                            const value = context.dataset.data[context.dataIndex];
                            return value >= 0 ? '#34A853' : '#EA4335';
                        },
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'right',
                            formatter: function(value) {
                                return `${value > 0 ? '+' : ''}${value}%`;
                            },
                            color: '#333',
                            font: {
                                weight: 'bold'
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '环比增长率 (%)'
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        async function exportToWord() {
            // 将图表转换为图片
            const charts = [
                { id: 'barChart', name: '部门金额排名' },
                { id: 'pieChart', name: '部门金额分布' },
                { id: 'lineChart', name: '合同金额趋势' },
                { id: 'barHorizontalChart', name: '毛利增长率' }
            ];
            
            const chartImages = {};
            
            for (const chart of charts) {
                const canvas = document.getElementById(chart.id);
                chartImages[chart.id] = canvas.toDataURL('image/png');
            }
            
            // 克隆整个页面内容
            const element = document.documentElement.cloneNode(true);
            
            // 移除下载按钮
            const downloadButtons = element.querySelectorAll('.download-btn, .footer-download-btn');
            downloadButtons.forEach(btn => btn.remove());
            
            // 将图表替换为图片
            for (const chart of charts) {
                const canvasEl = element.querySelector(`#${chart.id}`);
                if (canvasEl) {
                    const img = document.createElement('img');
                    img.src = chartImages[chart.id];
                    img.style.width = '100%';
                    img.alt = chart.name;
                    canvasEl.parentNode.replaceChild(img, canvasEl);
                }
            }
            
            // 创建HTML内容
            const htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>企业营销合同数据分析报告</title>
                    <style>
                        body { font-family: 'Microsoft YaHei', sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
                        h1 { text-align: center; color: #1e88e5; margin-bottom: 20px; }
                        .section { margin-bottom: 30px; }
                        .kpi-container { display: flex; justify-content: space-between; flex-wrap: wrap; margin-bottom: 25px; }
                        .kpi-card { background: #f8f9fa; border-radius: 5px; padding: 15px; flex: 1; min-width: 200px; margin: 0 10px 15px; text-align: center; }
                        .chart-row { display: flex; flex-wrap: wrap; justify-content: space-between; }
                        .chart-wrapper { width: 48%; margin-bottom: 20px; }
                        .chart-title { text-align: center; font-weight: bold; margin-bottom: 10px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #1e88e5; color: white; }
                        .positive { color: #4caf50; }
                        .negative { color: #f44336; }
                    </style>
                </head>
                <body>
                    ${element.innerHTML}
                </body>
                </html>
            `;
            
            // 转换为Word文档
            const converted = htmlDocx.asBlob(htmlContent, {
                orientation: 'landscape',
                margins: { top: 100, right: 100, bottom: 100, left: 100 }
            });
            
            // 保存文件
            saveAs(converted, '企业营销合同数据分析报告.docx');
        }
    </script>
</body>
</html>
```